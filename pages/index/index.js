(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"139b":function(e,o,t){"use strict";t.r(o);var n=t("2a3d"),s=t.n(n);for(var i in n)["default"].indexOf(i)<0&&function(e){t.d(o,e,(function(){return n[e]}))}(i);o["default"]=s.a},"2a3d":function(e,o,t){"use strict";(function(e){var n=t("47a9");Object.defineProperty(o,"__esModule",{value:!0}),o.default=void 0;var s=n(t("7eb4")),i=n(t("3b2d")),r=n(t("ee10"));function a(e,o){var t="undefined"!==typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=function(e,o){if(!e)return;if("string"===typeof e)return u(e,o);var t=Object.prototype.toString.call(e).slice(8,-1);"Object"===t&&e.constructor&&(t=e.constructor.name);if("Map"===t||"Set"===t)return Array.from(e);if("Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return u(e,o)}(e))||o&&e&&"number"===typeof e.length){t&&(e=t);var n=0,s=function(){};return{s:s,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:s}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,r=!0,a=!1;return{s:function(){t=t.call(e)},n:function(){var e=t.next();return r=e.done,e},e:function(e){a=!0,i=e},f:function(){try{r||null==t.return||t.return()}finally{if(a)throw i}}}}function u(e,o){(null==o||o>e.length)&&(o=e.length);for(var t=0,n=new Array(o);t<o;t++)n[t]=e[t];return n}var c=getApp(),d={data:function(){return{applet:{},page:{},shop:{},goods:{image:{url:""},spec:[{goods_price:"",line_price:""}]},goods_detail_show:!1,show:!1,specData:{},goods_sku_id:"",spec_name:"",goods_price:"",line_price:"",goods_img:"",stock_num:0,goods_spec_arr:[],spec_index:0}},props:{},onLoad:function(e){var o=this;return(0,r.default)(s.default.mark((function t(){var n,i,r;return s.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return n=o,i="",r="",r=decodeURIComponent(e.scene),i=decodeURIComponent(e.q),t.next=5,n.$onLaunched;case 5:n.applet=c.getApplet(),n.shop=n.applet.shop,"undefined"!=i&&""!=i&&c.getQrcode(i,!0),"undefined"!==r&&""!=r&&c.getQrcode(r);case 9:case"end":return t.stop()}}),t)})))()},onShow:function(){this.getIndexData()},onShareAppMessage:function(){return{title:this.applet.navbar.params.share_title,imageUrl:this.applet.navbar.params.share_image,path:"/pages/index/index?recommender="+c.getUserId()}},methods:{cart_input:function(e){var o=this,t=o.goods;return!!e&&(0==o.shop.status?(c.showError(this.$t("index.index.store_rest")),!1):void c._post_form("cart/edit",{goods_id:t.goods_id,goods_num:e,goods_sku_id:t.spec[0].spec_sku_id},(function(){t.total_num=e,o.goods=t})))},cart_focus:function(){this.goods;if(0==this.shop.status)return c.showError(this.$t("index.index.store_rest")),!1},minusCount:function(){var e=this,o=e.goods;return 0==e.shop.status?(c.showError(this.$t("index.index.store_rest")),!1):20==o.spec_type?(e.specShow(o),!0):(o.total_num>1&&c._post_form("cart/sub",{goods_id:o.goods_id,goods_sku_id:o.spec[0].spec_sku_id},(function(){o.total_num--,e.goods=o})),void(1==o.total_num&&c._post_form("cart/delete",{goods_id:o.goods_id,goods_sku_id:o.spec[0].spec_sku_id},(function(t){o.total_num--,e.goods=o}))))},addCount:function(){var e=this,o=e.goods;return 0==e.shop.status?(c.showError(this.$t("index.index.store_rest")),!1):20==o.spec_type?(e.specShow(o),!0):void c._post_form("cart/add",{goods_id:o.goods_id,goods_num:1,goods_sku_id:o.spec[0].spec_sku_id},(function(){o.total_num++,e.goods=o}))},specShow:function(e){for(var o,t=0;t<e.specData.spec_attr.length;t++)for(var n=0;n<e.specData.spec_attr[t].spec_items.length;n++)0==n?(e.specData.spec_attr[t].spec_items[0].checked=!0,this.goods_spec_arr[t]=e.specData.spec_attr[t].spec_items[0].item_id):e.specData.spec_attr[t].spec_items[n].checked=!1;console.log("733"),console.log(e),o=e.specData;var s=o.spec_list[0],i=e.image.url;""!=s.form.image_url&&(i=s.form.image_url),this.setData({show:!0,goods:e,specData:o,goods_sku_id:s.goods_spec_id,spec_name:s.spec_name,goods_price:s.form.goods_price,line_price:s.form.line_price,goods_img:i,stock_num:s.form.stock_num})},up:function(){var e=this,o=e.spec_index,t=e.goods;if(0==e.shop.status)return c.showError(this.$t("index.index.store_rest")),!1;c._post_form("cart/add",{goods_id:t.goods_id,goods_num:1,goods_sku_id:t.spec[o].spec_sku_id},(function(){t.spec[o].sell_num++,t.total_num++,e.goods=t}))},down:function(){var e=this,o=e.spec_index,t=e.goods;if(0==e.shop.status)return c.showError(this.$t("index.index.store_rest")),!1;t.spec[o].sell_num>1&&c._post_form("cart/sub",{goods_id:t.goods_id,goods_sku_id:t.spec[o].spec_sku_id},(function(){t.spec[o].sell_num--,t.total_num--,e.goods=t})),1==t.spec[o].sell_num&&c._post_form("cart/delete",{goods_id:t.goods_id,goods_sku_id:t.spec[o].spec_sku_id},(function(n){t.spec[o].sell_num--,t.total_num--,e.goods=t}))},specTap:function(e,o){var t=this.specData;for(var n in t.spec_attr)for(var s in t.spec_attr[n].spec_items)e==n&&(t.spec_attr[n].spec_items[s].checked=!1,o==s&&(t.spec_attr[n].spec_items[o].checked=!0,this.goods_spec_arr[n]=t.spec_attr[n].spec_items[o].item_id));this.specData=t,this.updateSpecGoods()},updateSpecGoods:function(){for(var e,o=this.goods_spec_arr.join("_"),t=this.specData.spec_list,n=0,s="",r=0;r<t.length;r++)if(t[r].spec_sku_id==o){e=t[r],n=r;break}console.log("861"),console.log(this.goods),s=""==e.form.image_url?this.goods.image.url:e.form.image_url,"object"===(0,i.default)(e)&&this.setData({goods_sku_id:e.spec_sku_id,spec_name:e.spec_name,goods_price:e.form.goods_price,line_price:e.form.line_price,spec_index:n,goods_img:s,stock_num:e.form.stock_num})},getIndexData:function(){var e=this;c._get("index/page",{},(function(o){e.page=o.data}))},goodsDetail:function(o){var t=this;c._get("goods/detail",{goods_id:o},(function(o){t.goods=o.data,t.goods_detail_show=!0,console.log("901"),console.log(t.goods),e.$u.mpShare.title=t.goods.goods_name+" - "+t.applet.shop.shop_name,e.$u.mpShare.imageUrl=t.goods.image.url}))},phone:function(o){e.makePhoneCall({phoneNumber:o})},banner:function(e){var o,t=a(this.page);try{for(t.s();!(o=t.n()).done;){var n=o.value;"banner"==n.type&&(console.log("924"),console.log(n.data),this.goTo(n.data[e].url))}}catch(s){t.e(s)}finally{t.f()}},notice:function(e){var o,t=a(this.page);try{for(t.s();!(o=t.n()).done;){var n=o.value;"notice"==n.type&&(console.log("937"),console.log(n.data),this.goTo(n.data.url[e]))}}catch(s){t.e(s)}finally{t.f()}},food:function(o){e.setStorageSync("order_mode",o),c.goTo("shop/index")},navBar2:function(e){"scan"==e?this.scanCode():this.goTo(e)},h5Login:function(o){c._post_form("h5/login",{token:o},(function(o){e.setStorageSync("user",o.data)}),!1,!1)},scanCode:function(){e.scanCode({onlyFromCamera:!0,scanType:["qrCode"],success:function(e){console.log(e),"scanCode:ok"==e.errMsg||c.showError(this.$t("index.index.scan_err"))}})},goTo:function(e){c.goTo(e)}}};o.default=d}).call(this,t("df3c")["default"])},"37ea":function(e,o,t){"use strict";t.r(o);var n=t("3a97"),s=t("139b");for(var i in s)["default"].indexOf(i)<0&&function(e){t.d(o,e,(function(){return s[e]}))}(i);t("ba08");var r=t("828b"),a=Object(r["a"])(s["default"],n["b"],n["c"],!1,null,"bab304ae",null,!1,n["a"],void 0);o["default"]=a.exports},"3a97":function(e,o,t){"use strict";t.d(o,"b",(function(){return s})),t.d(o,"c",(function(){return i})),t.d(o,"a",(function(){return n}));var n={uSwiper:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-swiper/u-swiper")]).then(t.bind(null,"4fe1"))},uImage:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-image/u-image")]).then(t.bind(null,"6dce"))},uNoticeBar:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-notice-bar/u-notice-bar")]).then(t.bind(null,"e2d3"))},uGrid:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-grid/u-grid")]).then(t.bind(null,"f526"))},uGridItem:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-grid-item/u-grid-item")]).then(t.bind(null,"b788"))},uIcon:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-icon/u-icon")]).then(t.bind(null,"fa8a"))},uParse:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-parse/u-parse")]).then(t.bind(null,"1f78"))},uPopup:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-popup/u-popup")]).then(t.bind(null,"5f49"))},"u-Input":function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u--input/u--input")]).then(t.bind(null,"07cc"))},uButton:function(){return Promise.all([t.e("common/vendor"),t.e("uni_modules/uview-ui/components/u-button/u-button")]).then(t.bind(null,"1750"))}},s=function(){var e=this,o=e.$createElement,t=(e._self._c,e.__map(e.page,(function(o,t){var n=e.__get_orig(o),s="window"!==o.type||o.style.layout>-1?null:o.data.length,i="window"!==o.type||o.style.layout>-1?null:o.data.length,r="window"!==o.type||o.style.layout>-1?null:o.data.length,a="goods"===o.type&&o.data.length>0,u=a&&"list"==o.style.display&&1==o.style.column?e.__map(o.data,(function(t,n){var s=e.__get_orig(t),i=o.style.show.goodsSales?e.$t("index.index.sold"):null;return{$orig:s,m0:i}})):null;return{$orig:n,g0:s,g1:i,g2:r,g3:a,l0:u}}))),n=e.goods&&e.goods.month_sales>0?e.$t("index.index.monthly_sales"):null,s=e.goods&&e.shop.status&&!(10==e.goods.spec_type||e.goods.total_num>0)?e.$t("common.select"):null,i=e.goods?e.$t("common.purchase_quantity"):null,r=e.goods?e.$t("common.confirm_selection"):null;e._isMounted||(e.e0=function(o,t){var n=arguments[arguments.length-1].currentTarget.dataset,s=n.eventParams||n["event-params"];t=s.item;""!=t.params.url&&e.goTo(t.params.url)},e.e1=function(o){e.goods_detail_show=!1},e.e2=function(o){e.show=!1,e.spec_index=0},e.e3=function(o){e.show=!1,e.spec_index=0}),e.$mp.data=Object.assign({},{$root:{l1:t,m1:n,m2:s,m3:i,m4:r}})},i=[]},7222:function(e,o,t){"use strict";(function(e,o){var n=t("47a9");t("8ae9");n(t("3240"));var s=n(t("37ea"));e.__webpack_require_UNI_MP_PLUGIN__=t,o(s.default)}).call(this,t("3223")["default"],t("df3c")["createPage"])},"8ff5":function(e,o,t){},ba08:function(e,o,t){"use strict";var n=t("8ff5"),s=t.n(n);s.a}},[["7222","common/runtime","common/vendor"]]]);