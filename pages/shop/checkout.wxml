<view class="hm-p-b-100 data-v-068745b9"><view class="hm-header-xian data-v-068745b9"></view><block wx:if="{{order_mode==10||order_mode==30}}"><view class="hm-bg-f hm-p-lr-20 data-v-068745b9"><view class="hm-p-tb-20 hm-text-center hm-font-30 hm-font-b data-v-068745b9"># 堂食 #<block wx:if="{{table_id&&order_mode==10}}"><text class="hm-m-l-20 hm-col-tips data-v-068745b9">{{table_name}}</text></block></view><view class="tang data-v-068745b9"><view data-event-opts="{{[['tap',[['setOrderMode',[10]]]]]}}" class="{{['item','data-v-068745b9',order_mode==10?'br-checked':'br']}}" bindtap="__e"><image src="{{applet.domain+'/addons/single/applet/tang.png'}}" class="data-v-068745b9"></image><block wx:if="{{order_mode==10}}"><view class="icons data-v-068745b9"><u-icon vue-id="649bf6b0-1" name="checkmark" color="#ffffff" class="data-v-068745b9" bind:__l="__l"></u-icon></view></block><view class="title data-v-068745b9">堂食</view><view class="text data-v-068745b9">店内就餐</view></view><view data-event-opts="{{[['tap',[['setOrderMode',[30]]]]]}}" class="{{['item','hm-m-l-30','data-v-068745b9',order_mode==30?'br-checked':'br']}}" bindtap="__e"><image src="{{applet.domain+'/addons/single/applet/bao.png'}}" class="data-v-068745b9"></image><block wx:if="{{order_mode==30}}"><view class="icons data-v-068745b9"><u-icon vue-id="649bf6b0-2" name="checkmark" color="#ffffff" class="data-v-068745b9" bind:__l="__l"></u-icon></view></block><view class="title data-v-068745b9">打包</view><view class="text data-v-068745b9">自取带走</view></view></view></view></block><block wx:if="{{order_mode==20}}"><view class="hm-bg-f hm-p-lr-20 data-v-068745b9"><block wx:if="{{intra_region}}"><view class="hm-p-t-20 data-v-068745b9"><u-alert vue-id="649bf6b0-3" description="收货地址超出配送范围!" type="error" center="{{true}}" class="data-v-068745b9" bind:__l="__l"></u-alert></view></block><block wx:if="{{address}}"><view data-event-opts="{{[['tap',[['goTo',['user/address/index?from=flow']]]]]}}" class="hm-p-tb-20 data-v-068745b9" bindtap="__e"><view class="hm-font-b hm-font-28 data-v-068745b9">{{''+address.detail+''}}</view><view class="hm-font-26 hm-col-content hm-m-t-10 data-v-068745b9">{{''+address.name}}<text class="hm-m-l-10 data-v-068745b9">{{"("+address.gender.text+")"}}</text><text class="hm-m-l-30 data-v-068745b9">{{address.phone}}</text></view><view class="hm-dis-block-inline hm-fr data-v-068745b9" style="margin-top:-50rpx;"><u-icon vue-id="649bf6b0-4" name="arrow-right" color="#909193" class="data-v-068745b9" bind:__l="__l"></u-icon></view></view></block><block wx:else><view class="hm-p-tb-20 hm-text-center data-v-068745b9"><view class="hm-dis-block-inline data-v-068745b9"><u-button vue-id="649bf6b0-5" size="small" customStyle="{{({color:'#909193',padding:'0rpx 30rpx'})}}" text="添加地址" data-event-opts="{{[['^click',[['goTo',['user/address/add']]]]]}}" bind:click="__e" class="data-v-068745b9" bind:__l="__l"></u-button></view></view></block></view></block><view class="hm-bg-f hm-p-lr-20 hm-m-t-20 data-v-068745b9"><block wx:if="{{flavorList}}"><view class="hm-p-tb-20 hm-border-b data-v-068745b9"><block wx:for="{{flavorList}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view data-event-opts="{{[['tap',[['setFlavor',[index]]]]]}}" class="{{['data-v-068745b9',item.checked?'flavor-checked':'flavor']}}" bindtap="__e">{{''+item.name+''}}</view></block></view></block><view class="hm-p-tb-20 data-v-068745b9"><u--input bind:input="__e" vue-id="649bf6b0-6" placeholder="订单备注：" maxlength="50" clearable="{{true}}" value="{{message}}" data-event-opts="{{[['^input',[['__set_model',['','message','$event',[]]]]]]}}" class="data-v-068745b9" bind:__l="__l"></u--input></view></view><view class="hm-p-lr-20 hm-m-t-20 hm-bg-f data-v-068745b9"><view class="hm-p-tb-20 hm-font-28 data-v-068745b9">共<text class="hm-col-warning hm-font-30 hm-font-b data-v-068745b9">{{order_total_num}}</text>件商品</view><view class="hm-p-tb-20 hm-font-28 hm-col-content hm-border-t data-v-068745b9"><block wx:for="{{goods_list}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="data-v-068745b9">{{''+(index+1)+'.'}}<text class="hm-m-l-10 data-v-068745b9">{{item.goods_name}}</text><block wx:if="{{item.goods_sku.goods_attr}}"><text class="hm-font-26 hm-col-tips hm-p-l-10 data-v-068745b9">{{''+item.goods_sku.goods_attr+''}}</text></block><view class="hm-dis-block-inline hm-m-l-10 data-v-068745b9"><block wx:if="{{item.active}}"><u-tag vue-id="{{'649bf6b0-7-'+index}}" text="{{item.active}}" type="error" size="mini" plain="{{true}}" class="data-v-068745b9" bind:__l="__l"></u-tag></block></view><view class="hm-dis-block-inline hm-fr data-v-068745b9" style="width:240rpx;">{{'￥'+item.goods_price+"×"+item.total_num+''}}<text class="hm-fr data-v-068745b9">{{"￥"+item.goods_price*item.total_num}}</text></view></view></block><block wx:if="{{gift}}"><view class="data-v-068745b9">{{''+($root.g0+1)+"."}}<text class="hm-m-l-10 data-v-068745b9">{{gift.name}}</text><view class="hm-dis-block-inline hm-m-l-10 data-v-068745b9"><block wx:if="{{item.active}}"><u-tag vue-id="649bf6b0-8" text="{{item.active}}" type="success" size="mini" plain="{{true}}" class="data-v-068745b9" bind:__l="__l"></u-tag></block></view><view class="hm-dis-block-inline hm-fr data-v-068745b9" style="width:240rpx;">￥0.00×1<text class="hm-fr data-v-068745b9">￥0.00</text></view></view></block></view><view class="hm-p-tb-20 hm-font-28 hm-border-t hm-text-right data-v-068745b9">商品合计：<text class="hm-col-error data-v-068745b9">{{"￥"+order_total_price}}</text></view></view><view class="hm-p-lr-20 hm-m-t-20 hm-font-28 hm-bg-f data-v-068745b9"><block wx:if="{{pack_price>0}}"><view class="hm-p-tb-20 hm-border-t data-v-068745b9">包装费用：<text class="hm-col-error hm-fr data-v-068745b9">{{"+￥"+pack_price}}</text></view></block><block wx:if="{{delivery_price>0}}"><view class="hm-p-tb-20 hm-border-t data-v-068745b9">配送费用：<text class="hm-col-error hm-fr data-v-068745b9">{{"+￥"+delivery_price}}</text></view></block><block wx:if="{{ware_price>0&&people>0}}"><view data-event-opts="{{[['tap',[['e0',['$event']]]]]}}" class="hm-p-tb-20 hm-border-t data-v-068745b9" bindtap="__e">茶位费用：<view class="hm-dis-block-inline hm-fr data-v-068745b9"><text class="hm-col-tips data-v-068745b9">{{"（"+people+"人）"}}</text><text class="hm-col-error data-v-068745b9">{{"+￥"+ware_price}}</text><view class="hm-dis-block-inline hm-m-l-10 data-v-068745b9"><u-icon vue-id="649bf6b0-9" name="arrow-right" color="#909193" class="data-v-068745b9" bind:__l="__l"></u-icon></view></view></view></block><block wx:if="{{vip_price>0}}"><view class="hm-p-tb-20 hm-border-t data-v-068745b9">会员优惠：<text class="hm-col-error hm-fr data-v-068745b9"><block wx:if="{{free_delivery}}"><text class="data-v-068745b9">（免配送费）</text></block>{{"-￥"+vip_price}}</text></view></block><view data-event-opts="{{[['tap',[['e1',['$event']]]]]}}" class="hm-p-tb-20 hm-border-t data-v-068745b9" bindtap="__e">券卡优惠：<view class="hm-dis-block-inline hm-fr data-v-068745b9"><text class="{{['data-v-068745b9',coupon_list?'hm-col-error':'hm-col-tips']}}"><block wx:if="{{coupon_user_id}}"><text class="data-v-068745b9">{{"-￥"+activity_price}}</text></block><block wx:else><text class="data-v-068745b9">{{(coupon_list?$root.g1+'张':'暂无')+"可用"}}</text></block></text><view class="hm-dis-block-inline hm-m-l-10 data-v-068745b9"><u-icon vue-id="649bf6b0-10" name="arrow-right" color="#909193" class="data-v-068745b9" bind:__l="__l"></u-icon></view></view></view></view><view class="hm data-v-068745b9">{{''+applet.copyright+''}}<text class="v data-v-068745b9">{{"V"+applet.version}}</text></view><view class="hm-footer-fixed data-v-068745b9"><view class="bottom-cart data-v-068745b9"><view class="pay data-v-068745b9">实付金额：<text class="hm-col-error hm-font-b data-v-068745b9">{{"￥"+order_pay_price}}</text></view><view class="hm-dis-block-inline hm-fr _div data-v-068745b9"><u-button vue-id="649bf6b0-11" disabled="{{intra_region}}" customStyle="{{({height:'100rpx',width:'200rpx'})}}" type="error" text="确认结算" data-event-opts="{{[['^click',[['setCashier']]]]}}" bind:click="__e" class="data-v-068745b9" bind:__l="__l"></u-button></view></view></view><u-popup vue-id="649bf6b0-12" show="{{cashier_show}}" mode="center" round="8" closeable="{{true}}" data-event-opts="{{[['^close',[['e2']]]]}}" bind:close="__e" class="data-v-068745b9" bind:__l="__l" vue-slots="{{['default']}}"><view class="hm-popup data-v-068745b9"><view class="hm-p-b-20 hm-border-b hm-text-center data-v-068745b9">支付收银台</view><view class="hm-p-tb-50 hm-text-center data-v-068745b9"><view class="hm-font-b hm-col-0 data-v-068745b9">￥<text class="hm-font-100 data-v-068745b9">{{order_pay_price}}</text></view><view class="hm-font-28 hm-col-content data-v-068745b9">订单支付</view></view><block wx:if="{{mp=='weixin'||mp=='other'}}"><view data-event-opts="{{[['tap',[['setPay',[1]]]]]}}" class="hm-p-20 hm-border-t hm-font-26 data-v-068745b9" bindtap="__e"><view class="hm-dis-block-inline hm-m-r-15 data-v-068745b9"><u-icon vue-id="{{('649bf6b0-13')+','+('649bf6b0-12')}}" name="weixin-circle-fill" size="20" color="#19be6b" class="data-v-068745b9" bind:__l="__l"></u-icon></view>微信<view class="hm-fr hm-dis-block-inline data-v-068745b9"><block wx:if="{{pay_mode==1}}"><u-icon vue-id="{{('649bf6b0-14')+','+('649bf6b0-12')}}" name="checkbox-mark" size="25" color="#fa3534" class="data-v-068745b9" bind:__l="__l"></u-icon></block></view></view></block><view data-event-opts="{{[['tap',[['setPay',[2]]]]]}}" class="hm-p-20 hm-border-t hm-font-26 data-v-068745b9" bindtap="__e"><view class="hm-m-r-15 hm-dis-block-inline data-v-068745b9"><u-icon vue-id="{{('649bf6b0-15')+','+('649bf6b0-12')}}" name="red-packet-fill" size="20" color="{{$root.m0<$root.m1?'#c0c4cc':'#FF9900'}}" class="data-v-068745b9" bind:__l="__l"></u-icon></view><text class="{{['data-v-068745b9',$root.m2<$root.m3?'hm-col-light':'']}}">余额(<text class="{{['data-v-068745b9',$root.m4<$root.m5?'':'hm-col-error']}}">{{"￥"+userInfo.money}}</text>)</text><view class="hm-fr hm-dis-block-inline data-v-068745b9"><block wx:if="{{pay_mode==2}}"><u-icon vue-id="{{('649bf6b0-16')+','+('649bf6b0-12')}}" name="checkbox-mark" size="25" color="#fa3534" class="data-v-068745b9" bind:__l="__l"></u-icon></block><block wx:if="{{$root.m6<$root.m7}}"><text class="hm-col-light data-v-068745b9">余额不足</text></block></view></view><block wx:if="{{order_mode==10&&after_pay==1}}"><view data-event-opts="{{[['tap',[['setPay',[0]]]]]}}" class="hm-p-20 hm-border-t hm-font-26 data-v-068745b9" bindtap="__e"><view class="hm-m-r-15 hm-dis-block-inline data-v-068745b9"><u-icon vue-id="{{('649bf6b0-17')+','+('649bf6b0-12')}}" name="rmb-circle-fill" size="20" color="#fa3534" class="data-v-068745b9" bind:__l="__l"></u-icon></view>先下单后支付<view class="hm-fr hm-dis-block-inline data-v-068745b9"><block wx:if="{{pay_mode==0}}"><u-icon vue-id="{{('649bf6b0-18')+','+('649bf6b0-12')}}" name="checkbox-mark" size="25" color="#fa3534" class="data-v-068745b9" bind:__l="__l"></u-icon></block></view></view></block><view class="hm-border-t hm-p-t-50 data-v-068745b9"><view class="hm-p-lr-b25 data-v-068745b9"><u-button vue-id="{{('649bf6b0-19')+','+('649bf6b0-12')}}" type="success" text="确认支付" data-event-opts="{{[['^click',[['subMsg']]]]}}" bind:click="__e" class="data-v-068745b9" bind:__l="__l"></u-button></view></view></view></u-popup><u-popup vue-id="649bf6b0-20" show="{{coupon_show}}" round="8" closeable="{{true}}" data-event-opts="{{[['^close',[['e3']]]]}}" bind:close="__e" class="data-v-068745b9" bind:__l="__l" vue-slots="{{['default']}}"><view class="hm-p-20 data-v-068745b9"><view class="hm-p-b-20 data-v-068745b9">选择优惠券</view><block wx:for="{{coupon_list}}" wx:for-item="item" wx:for-index="index" wx:key="index"><view class="coupon data-v-068745b9"><view class="item data-v-068745b9"><view class="use data-v-068745b9"><u-button vue-id="{{('649bf6b0-21-'+index)+','+('649bf6b0-20')}}" size="small" customStyle="{{({color:'#999'})}}" text="使用" data-event-opts="{{[['^click',[['useCoupon',[index]]]]]}}" bind:click="__e" class="data-v-068745b9" bind:__l="__l"></u-button></view><view class="hm-col-main data-v-068745b9">{{item.coupon.name}}</view><view class="hm-m-t-10 hm-font-22 data-v-068745b9">{{"可用时间："+item.expire_star.text+" 至 "+item.expire_end.text+''}}</view><view class="hm-font-22 data-v-068745b9">{{"规则："+item.coupon.explain}}</view></view></view></block></view></u-popup><u-popup vue-id="649bf6b0-22" show="{{peopleShow}}" zIndex="900000" mode="center" round="10" class="data-v-068745b9" bind:__l="__l" vue-slots="{{['default']}}"><view class="hm-popup data-v-068745b9"><view class="hm-p-b-20 hm-border-b data-v-068745b9">就餐人数</view><view class="hm-p-20 data-v-068745b9"><u--input bind:input="__e" vue-id="{{('649bf6b0-23')+','+('649bf6b0-22')}}" type="number" placeholder="请输入就餐人数" inputAlign="center" focus="{{true}}" clearable="{{true}}" value="{{people}}" data-event-opts="{{[['^input',[['__set_model',['','people','$event',[]]]]]]}}" class="data-v-068745b9" bind:__l="__l"></u--input></view><view class="hm-p-lr-b25 data-v-068745b9"><u-button vue-id="{{('649bf6b0-24')+','+('649bf6b0-22')}}" type="success" text="确认人数" data-event-opts="{{[['^click',[['setPeople']]]]}}" bind:click="__e" class="data-v-068745b9" bind:__l="__l"></u-button></view></view></u-popup></view>